<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Functional Programming - Mastermind Project</span><span>
</span><span id="line-3"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright (c) 2022 Michael B. Gale (michael@fpclass.online)</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- This source code is subject to the terms and conditions found in the LICENSE</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- file in the root directory of this source tree.</span><span>
</span><span id="line-8"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">-- | This module should contain your game code.</span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Game</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">-- | The number of pegs in a code. You can change this value if you want to</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- play games with more than four pegs. You should make sure that you reference</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- this definition in your code instead of hard-coding the number 4 or writing</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- code that assumes this value is 4.</span><span>
</span><span id="line-19"></span><span class="annot"><a href="Game.html#pegs"><span class="hs-identifier hs-type">pegs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-20"></span><span id="pegs"><span class="annot"><span class="annottext">pegs :: Int
</span><a href="Game.html#pegs"><span class="hs-identifier hs-var hs-var">pegs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- | Symbols are represented by characters.</span><span>
</span><span id="line-23"></span><span class="hs-keyword">type</span><span> </span><span id="Symbol"><span class="annot"><a href="Game.html#Symbol"><span class="hs-identifier hs-var">Symbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-comment">-- | The available symbols in the game.</span><span>
</span><span id="line-26"></span><span class="annot"><a href="Game.html#symbols"><span class="hs-identifier hs-type">symbols</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-27"></span><span id="symbols"><span class="annot"><span class="annottext">symbols :: [Symbol]
</span><a href="Game.html#symbols"><span class="hs-identifier hs-var hs-var">symbols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Symbol
</span><span class="hs-char">'a'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Symbol
</span><span class="hs-char">'f'</span></span><span class="hs-special">]</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">-- | A code is represented by a list of symbols.</span><span>
</span><span id="line-30"></span><span class="hs-keyword">type</span><span> </span><span id="Code"><span class="annot"><a href="Game.html#Code"><span class="hs-identifier hs-var">Code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-comment">-- | Guesses are scored using coloured and white markers. The first component</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- of the pair gives the number of coloured markers and the right component</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- gives the number of white markers.</span><span>
</span><span id="line-35"></span><span class="hs-keyword">type</span><span> </span><span id="Score"><span class="annot"><a href="Game.html#Score"><span class="hs-identifier hs-var">Score</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- | A player is either human or computer-controlled.</span><span>
</span><span id="line-38"></span><span class="hs-keyword">data</span><span> </span><span id="Player"><span class="annot"><a href="Game.html#Player"><span class="hs-identifier hs-var">Player</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Human"><span class="annot"><a href="Game.html#Human"><span class="hs-identifier hs-var">Human</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Computer"><span class="annot"><a href="Game.html#Computer"><span class="hs-identifier hs-var">Computer</span></a></span></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- | The first codemaker in a play session.</span><span>
</span><span id="line-41"></span><span class="annot"><a href="Game.html#codemaker"><span class="hs-identifier hs-type">codemaker</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span>
</span><span id="line-42"></span><span id="codemaker"><span class="annot"><span class="annottext">codemaker :: Player
</span><a href="Game.html#codemaker"><span class="hs-identifier hs-var hs-var">codemaker</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="Game.html#Human"><span class="hs-identifier hs-var">Human</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- | The first guess the AI will make.</span><span>
</span><span id="line-45"></span><span class="annot"><a href="Game.html#firstGuess"><span class="hs-identifier hs-type">firstGuess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span>
</span><span id="line-46"></span><span id="firstGuess"><span class="annot"><span class="annottext">firstGuess :: [Symbol]
</span><a href="Game.html#firstGuess"><span class="hs-identifier hs-var hs-var">firstGuess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Symbol]
</span><span class="hs-string">&quot;aabb&quot;</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- | `correctGuess` @score@ determines whether @score@ indicates that a guess</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- was correct or not. For example:</span><span>
</span><span id="line-52"></span><span class="hs-comment">--</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- &gt;&gt;&gt; correctGuess (pegs, 0)</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-55"></span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- &gt;&gt;&gt; correctGuess (3, 1)</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-58"></span><span class="hs-comment">------------------------------------</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- [Your explanation]</span><span>
</span><span id="line-60"></span><span class="annot"><a href="Game.html#correctGuess"><span class="hs-identifier hs-type">correctGuess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-61"></span><span id="correctGuess"><span class="annot"><span class="annottext">correctGuess :: Score -&gt; Bool
</span><a href="Game.html#correctGuess"><span class="hs-identifier hs-var hs-var">correctGuess</span></a></span></span><span> </span><span id="local-6989586621679027723"><span class="annot"><span class="annottext">Score
</span><a href="#local-6989586621679027723"><span class="hs-identifier hs-var">score</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | `validateCode` @code@ checks that the code entered by a human player is</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- valid. In other words, it should have the length given by `pegs` and it</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- should only contain valid symbols. For example (assuming default</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- definitions of `pegs` and `symbols`):</span><span>
</span><span id="line-67"></span><span class="hs-comment">--</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- &gt;&gt;&gt; validateCode &quot;aabb&quot;</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-70"></span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- &gt;&gt;&gt; validateCode &quot;zzyy&quot;</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- &gt;&gt;&gt; validateCode &quot;ab&quot;</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-76"></span><span class="hs-comment">------------------------------------</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- [Your explanation]</span><span>
</span><span id="line-78"></span><span class="annot"><a href="Game.html#validateCode"><span class="hs-identifier hs-type">validateCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-79"></span><span id="validateCode"><span class="annot"><span class="annottext">validateCode :: [Symbol] -&gt; Bool
</span><a href="Game.html#validateCode"><span class="hs-identifier hs-var hs-var">validateCode</span></a></span></span><span> </span><span id="local-6989586621679027720"><span class="annot"><span class="annottext">[Symbol]
</span><a href="#local-6989586621679027720"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | `codes` is a list of all possible codes. For example, assuming default</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- definitions of `pegs` and `symbols`:</span><span>
</span><span id="line-83"></span><span class="hs-comment">--</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- &gt;&gt;&gt; codes</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- [&quot;aaaa&quot;, &quot;aaab&quot;, &quot;aaac&quot;, &quot;aaad&quot;, .., &quot;fffe&quot;, &quot;ffff&quot;]</span><span>
</span><span id="line-86"></span><span class="hs-comment">------------------------------------</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- [Your explanation]</span><span>
</span><span id="line-88"></span><span class="annot"><a href="Game.html#codes"><span class="hs-identifier hs-type">codes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span id="codes"><span class="annot"><span class="annottext">codes :: [[Symbol]]
</span><a href="Game.html#codes"><span class="hs-identifier hs-var hs-var">codes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Symbol]]
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | `results` is a list of all possible scores. Assuming default definitions</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- of `pegs`:</span><span>
</span><span id="line-93"></span><span class="hs-comment">--</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- &gt;&gt;&gt; results</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- [ (0,0), (0,1), (0,2), (0,3), (0,4), (1,0), (1,1), (1,2), (1,3), (2,0)</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- , (2,1), (2,2), (3,0), (4,0)</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- ]</span><span>
</span><span id="line-98"></span><span class="hs-comment">------------------------------------</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- [Your explanation]</span><span>
</span><span id="line-100"></span><span class="annot"><a href="Game.html#results"><span class="hs-identifier hs-type">results</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-101"></span><span id="results"><span class="annot"><span class="annottext">results :: [Score]
</span><a href="Game.html#results"><span class="hs-identifier hs-var hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Score]
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- | `score` @code guess@ scores @guess@ against @code@. Symbols which are</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- in the right place and of the right type score a coloured marker. Symbols</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- which are of the right type but in the wrong place score a white marker.</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- &gt;&gt;&gt; score &quot;abcd&quot; &quot;aabb&quot;</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- (1,1)</span><span>
</span><span id="line-109"></span><span class="hs-comment">------------------------------------</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- [Your explanation]</span><span>
</span><span id="line-111"></span><span class="annot"><a href="Game.html#score"><span class="hs-identifier hs-type">score</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span>
</span><span id="line-112"></span><span id="score"><span class="annot"><span class="annottext">score :: [Symbol] -&gt; [Symbol] -&gt; Score
</span><a href="Game.html#score"><span class="hs-identifier hs-var hs-var">score</span></a></span></span><span> </span><span id="local-6989586621679027716"><span class="annot"><span class="annottext">[Symbol]
</span><a href="#local-6989586621679027716"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621679027715"><span class="annot"><span class="annottext">[Symbol]
</span><a href="#local-6989586621679027715"><span class="hs-identifier hs-var">guess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Score
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | `nextGuess` @remainingOptions@ chooses the next guess from</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- @remainingOptions@. If there is only one option left, choose it.</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- Otherwise, calculate the hit score for each code and choose the code</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- with the largest hit score.</span><span>
</span><span id="line-118"></span><span class="hs-comment">------------------------------------</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- [Your explanation]</span><span>
</span><span id="line-120"></span><span class="annot"><a href="Game.html#nextGuess"><span class="hs-identifier hs-type">nextGuess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span>
</span><span id="line-121"></span><span id="nextGuess"><span class="annot"><span class="annottext">nextGuess :: [[Symbol]] -&gt; [Symbol]
</span><a href="Game.html#nextGuess"><span class="hs-identifier hs-var hs-var">nextGuess</span></a></span></span><span> </span><span id="local-6989586621679027713"><span class="annot"><span class="annottext">[[Symbol]]
</span><a href="#local-6989586621679027713"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Symbol]
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">-- | `eliminate` @lastScore guess remainingOptions@ returns a list of `Code`s</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- in which all codes from @remainingOptions@ which would result in</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- a different score for @guess@ if they were the code are removed.</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- In other words, given the set of remaining possible codes, narrow it down</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- to those which would produce the same score we got from the codemaker.</span><span>
</span><span id="line-128"></span><span class="hs-comment">------------------------------------</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- [Your explanation]</span><span>
</span><span id="line-130"></span><span class="annot"><a href="Game.html#eliminate"><span class="hs-identifier hs-type">eliminate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.html#Score"><span class="hs-identifier hs-type">Score</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-131"></span><span id="eliminate"><span class="annot"><span class="annottext">eliminate :: Score -&gt; [Symbol] -&gt; [[Symbol]] -&gt; [[Symbol]]
</span><a href="Game.html#eliminate"><span class="hs-identifier hs-var hs-var">eliminate</span></a></span></span><span> </span><span id="local-6989586621679027711"><span class="annot"><span class="annottext">Score
</span><a href="#local-6989586621679027711"><span class="hs-identifier hs-var">lastScore</span></a></span></span><span> </span><span id="local-6989586621679027710"><span class="annot"><span class="annottext">[Symbol]
</span><a href="#local-6989586621679027710"><span class="hs-identifier hs-var">guess</span></a></span></span><span> </span><span id="local-6989586621679027709"><span class="annot"><span class="annottext">[[Symbol]]
</span><a href="#local-6989586621679027709"><span class="hs-identifier hs-var">codes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Symbol]]
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-134"></span></pre></body></html>